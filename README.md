## 这是一个Mediasoup的集群项目

## 出发点
1. mediasoup没有提供集群方案，只是隐约说到PipTransport可以实现
2. mediasoup基于房间，提供了js接口。
3. mediasoup没有完整的native客户端demo，如pc的qt，Android的java，ios的oc。

## 目标
1. 实现mediasoup集群商用部署
2. 要根据地域，运营商，优先级进行集群调度，区域用户隔离。
3. 要做到【命名空间】隔离不同的用户群。
4. 要做集群的可视化监控管理
5. 转发到传统直播如RTMP服务器做大规模直播。
6. 转发到存储服务器做存储。
7. 媒体和信令分离

## 方案对比
集群可以基于一下三个基础来做：
1. 基于房间，同一个房间调度到同一个服务器。 无法跨地域。
2. 基于用户，同一个用户调度到同一个服务器。 服务要内部转发。
3. 基于音视频流，同一个流掉才调度同一个服务器。客户端连接太多，服务也可能要内部转发。

目前的三种方案，来自：https://mediasoup.discourse.group/t/recommended-mediasoup-cluster-topology/1497
1. 第一种：同一个room调度到同一个服务器。非常简单。不改mediasoup。无法地区隔离用户。
2. 第二种：一个room的用户分散到不同的物理服务器，用户需要创建很多个transport连接很多服务器。连接太多，客户端复杂。
3. 第三种：同一个room的用户连接到1-2台服务器，只有收发两个transport，worker内部用pipeToRouter转发。服务端复杂。

## 方案选择与计划
1. 第一步：基于房间的集群，四个模块
    - 通讯节点：mediasoup-demo程序，可以不断扩展。
    - 数据同步：redis/rabitmq。
    - 调度中心：
        - 保证同一个room的用户分配到一个服务器。
        - 同时做负载均衡
        - 新建房间是调度到所在区域。
    - 集群可视化管理web
2. 第二步：基于用户或者流
    - 信令和媒体分离
## 运行方式


